

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Combine &mdash; F1tenth latest documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../_static/js/custom.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="alternate" hreflang="en" href="https://docs.godotengine.org/en/" />
    <link rel="alternate" hreflang="de" href="https://docs.godotengine.org/de/" />
    <link rel="alternate" hreflang="es" href="https://docs.godotengine.org/es/" />
    <link rel="alternate" hreflang="fr" href="https://docs.godotengine.org/fr/" />
    <link rel="alternate" hreflang="ko" href="https://docs.godotengine.org/ko/" />
    <link rel="alternate" hreflang="pl" href="https://docs.godotengine.org/pl/" />
    <link rel="alternate" hreflang="pt-br" href="https://docs.godotengine.org/pt-br/" />
    <link rel="alternate" hreflang="uk" href="https://docs.godotengine.org/uk/" />
    <link rel="alternate" hreflang="zh-cn" href="https://docs.godotengine.org/zh-cn/" />
    <link rel="alternate" hreflang="x-default" href="https://docs.godotengine.org/" />
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Simulation" href="simulation.html" />
    <link rel="prev" title="Wireless" href="wireless.html" />
 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/f1_stickers_02.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../about/introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/crew.html">Crew</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/faq.html">Frequently asked questions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../about/faq.html#what-can-i-do-with-godot-how-much-does-it-cost-what-are-the-license-terms">What can I do with Godot? How much does it cost? What are the license terms?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../about/docs_changelog.html">Documentation changelog</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../bom.html">Bill of Materials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Assemble</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="hardware.html">Mechanical</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hardware.html#preparing-and-assembling-the-car">Preparing and Assembling the Car</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#preparing-the-car">Preparing the Car</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#installing-the-body-standoffs">Installing the Body Standoffs</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#mounting-the-focbox-to-the-chassis">Mounting the FOCbox to the Chassis</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#installing-the-chassis-standoffs">Installing the Chassis Standoffs</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#detaching-the-jetson-from-the-development-board">Detaching the Jetson from the Development Board</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#mounting-the-wi-fi-antennas-to-the-power-board">Mounting the Wi-Fi Antennas to the Power Board</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#mounting-the-power-board-to-the-chassis">Mounting the Power Board to the Chassis</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#attaching-the-orbitty-to-the-jetson">Attaching the Orbitty to the Jetson</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#connecting-the-jetson-and-power-board">Connecting the Jetson and Power Board</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#mounting-the-jetson-to-the-chassis">Mounting the Jetson to the Chassis</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#mounting-the-chassis-to-the-car-underbody">Mounting the Chassis to the Car Underbody</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#mounting-the-lidar">Mounting the LIDAR</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#mounting-the-usb-hubs">Mounting the USB Hubs</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#connecting-the-lidar">Connecting the LIDAR</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#connecting-the-focbox">Connecting the FOCbox</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#connecting-the-car-to-the-battery">Connecting the Car to the Battery</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#tuning-the-focboxs-pid-gains">Tuning the FOCbox’s PID Gains</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware.html#lipo-lithium-polymer-battery-safety">LiPo (Lithium Polymer) Battery Safety</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="software.html">Software</a><ul>
<li class="toctree-l3"><a class="reference internal" href="software.html#on-your-laptop">On Your Laptop</a><ul>
<li class="toctree-l4"><a class="reference internal" href="software.html#supported-versions">Supported Versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="software.html#install-ros">Install ROS</a></li>
<li class="toctree-l4"><a class="reference internal" href="software.html#connect-terminals-to-the-jetson-aka-the-device">Connect terminals to the Jetson (aka the device)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="software.html#install-linux">Install Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="software.html#flash-the-jetpack">Flash the Jetpack</a></li>
<li class="toctree-l3"><a class="reference internal" href="software.html#re-flash-the-orbitty">Re-flash the Orbitty</a></li>
<li class="toctree-l3"><a class="reference internal" href="software.html#id1">Install ROS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wireless.html">Wireless</a><ul>
<li class="toctree-l3"><a class="reference internal" href="wireless.html#connecting-the-car-to-the-access-point">Connecting the Car to the Access Point</a></li>
<li class="toctree-l3"><a class="reference internal" href="wireless.html#connecting-your-computer-to-the-access-point">Connecting Your Computer to the Access Point</a></li>
<li class="toctree-l3"><a class="reference internal" href="wireless.html#linux">Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="wireless.html#windows">Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="wireless.html#mac-os">Mac OS</a></li>
<li class="toctree-l3"><a class="reference internal" href="wireless.html#sshing-into-the-car">SSHing into the Car</a></li>
<li class="toctree-l3"><a class="reference internal" href="wireless.html#setting-up-wireless-hot-spot-on-jetson">Setting Up Wireless Hot Spot on Jetson</a></li>
<li class="toctree-l3"><a class="reference internal" href="wireless.html#setting-up-vnc-server-on-jetson">Setting Up VNC Server on Jetson</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Combine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hokuyo-10lx-ethernet-connection-setup">Hokuyo 10LX Ethernet Connection Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#working-directory-setup">Working Directory Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#udev-rules-setup">Udev Rules Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manual-control">Manual Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tuning-the-vesc-parameters">Tuning the VESC Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#testing-the-lidar-usb-only">Testing the Lidar (USB Only)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#recording-bag-data-on-the-car">Recording Bag Data on the Car</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="simulation.html">Simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="simulation.html#want-a-different-navigation-algorithm">Want a Different Navigation Algorithm?</a></li>
<li class="toctree-l3"><a class="reference internal" href="simulation.html#want-a-different-track">Want a Different Track?</a></li>
<li class="toctree-l3"><a class="reference internal" href="simulation.html#dont-want-the-gui">Don’t Want the GUI?</a></li>
<li class="toctree-l3"><a class="reference internal" href="simulation.html#creating-a-world">Creating a World</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="algorithms.html">Algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="algorithms.html#wall-following">Wall Following</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithms.html#wall-following-with-explicit-instructions">Wall Following with Explicit Instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithms.html#gap-finding-in-lidar-scans-houssam">Gap-finding in LiDAR Scans [Houssam]</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithms.html#scan-matching-odometry-sheil">Scan Matching Odometry [Sheil]</a><ul>
<li class="toctree-l4"><a class="reference internal" href="algorithms.html#installing-packages">Installing Packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="algorithms.html#getting-the-example-launch-file">Getting the Example Launch File</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="algorithms.html#localization-with-hector-slam">Localization with Hector SLAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithms.html#localization-with-amcl-adaptive-monte-carlo-localization">Localization with AMCL (Adaptive Monte Carlo Localization)</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithms.html#localization-with-particle-filter-faster-and-more-accurate-than-amcl">Localization with Particle Filter (Faster and More Accurate than AMCL)</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithms.html#generating-waypoints">Generating Waypoints</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithms.html#following-waypoints-with-pure-pursuit">Following Waypoints with Pure Pursuit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="algorithms.html#pure-pursuit-speed-control-algorithm">Pure Pursuit Speed Control Algorithm</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="algorithms.html#path-planning-with-ros-move-base">Path Planning with ROS move_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="algorithms.html#path-planning-with-teb-timed-elastic-band-local-planner">Path Planning with TEB (Timed Elastic Band) Local Planner</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index.html">Appendices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix_a.html">Appendix A: Flashing Jetpack via a VM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_a.html#spin-up-an-ubuntu-vm">1.2 Spin up an Ubuntu VM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_a.html#download-nvidia-jetpack">1.3 Download NVIDIA JetPack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_a.html#install-jetpack">1.4 Install JetPack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_a.html#validation-flash">1.5 Validation Flash</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix_b.html">Appendix B: Shared Folders between Host and VM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix_c.html">Appendix C: Soldering the Power Board</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_c.html#lipo-protection-module-u-2">LiPO Protection Module (U$2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_c.html#nvidia-power-supply-jack-u-7">NVIDIA Power Supply Jack (U$7)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_c.html#terminal-blocks-x1-x9-and-some-small-capacitors-c8-c9">Terminal Blocks (X1 - X9) and Some Small Capacitors (C8, C9)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_c.html#small-slider-switches-sw1-sw2-battery-power-jack-u-10-and-remaining-small-capacitors-c3-c4-c5-and-c6">Small Slider Switches (SW1, SW2), Battery Power Jack (U$10), and Remaining Small Capacitors (C3, C4, C5, and C6)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_c.html#resistors-r1-r2-r3-and-headers-u-1-con1-con2-con3-con4">Resistors (R1, R2, R3) and Headers (U$1, CON1, CON2, CON3, CON4)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_c.html#battery-dc-to-12v-dc-converter">Battery DC to 12V DC Converter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_c.html#v-to-8v-converter-u1-leds-d1-d2-and-d3-and-large-capacitors-c1-c2-and-c7">12V to 8V Converter (U1), LEDs (D1, D2, and D3), and Large Capacitors (C1, C2, and C7)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_c.html#large-toggle-switches-u-3-u-4-and-u-5">Large Toggle Switches (U$3, U$4, and U$5)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_c.html#testing-the-board">Testing the Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_c.html#cleaning-the-board-optional">Cleaning the Board (Optional)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix_d.html">Appendix D: FAQ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_d.html#general">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_d.html#mechanical">Mechanical</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../appendix/appendix_d.html#do-i-have-a-broken-drive-train-how-can-i-fix-it">Do I have a broken drive train? How can I fix it?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_d.html#wireless-network">Wireless Network</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../appendix/appendix_d.html#high-packet-loss-excessive-latency-on-wireless-network">High packet-loss, excessive latency on wireless network…</a></li>
<li class="toctree-l4"><a class="reference internal" href="../appendix/appendix_d.html#increasing-range-of-the-gamepad">Increasing range of the gamepad</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_d.html#software">Software</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_d.html#kernel">Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendix/appendix_d.html#simulation-and-experiments-without-hardware">Simulation and Experiments without Hardware</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Learn</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../learn/index.html">Learn</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../learn/code.html">Code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../learn/code.html#lectures">Lectures</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Press</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../press/index.html">Press</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../press/logos.html">Logos</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">contact</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">F1tenth</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Assemble</a> &raquo;</li>
        
      <li>Combine</li>
    
    


      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/godotengine/godot-docs/blob/master/getting_started/step_by_step/combine.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    


  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="combine">
<span id="doc-combine"></span><h1>Combine<a class="headerlink" href="#combine" title="Permalink to this headline">¶</a></h1>
<div class="section" id="hokuyo-10lx-ethernet-connection-setup">
<h2>Hokuyo 10LX Ethernet Connection Setup<a class="headerlink" href="#hokuyo-10lx-ethernet-connection-setup" title="Permalink to this headline">¶</a></h2>
<p>Coming Soon: Add pictures and snippets.</p>
<p>In order to utilize the 10LX you must first configure the eth0 network. From the factory the 10LX is assigned the following ip: 192.168.0.10. Note that the lidar is on subnet 0.</p>
<p>First create a new wired connection.</p>
<p>In the ipv4 tab add a route such that the eth0 port on the Jetson is assigned ip address 192.168.0.15, the subnet mask is 255.255.255.0, and the gateway is 192.168.0.1. Call the connection Hokuyo. Save the connection and close the network configuration GUI.</p>
<p>When you plug in the 10LX make sure that the Hokuyo connection is selected. If everything is configured properly you should now be able to ping 192.168.0.1.</p>
<p>In the racecar config folder under ‘lidar_node’ set the following parameter: ‘ip_address: 192.168.0.10’. In addition in the sensors.launch.xml change the argument for the lidar launch from ‘hokuyo_node’ to ‘urg_node’ do the same thing for the node_type parameter.</p>
</div>
<div class="section" id="working-directory-setup">
<h2>Working Directory Setup<a class="headerlink" href="#working-directory-setup" title="Permalink to this headline">¶</a></h2>
<p>On your host computer (e.g., your laptop), setup your working directory (the F1/10th car and simulator) by following these steps.</p>
<p>Clone the following repository into a folder on your computer.</p>
<dl class="docutils">
<dt>c</dt>
<dd>$​ ​cd​ ~/sandbox (or whatever folder you want to work ​in​)
$​ git ​clone​ <a class="reference external" href="https://github.com/mlab-upenn/f110-fall2018-skeletons.git">https://github.com/mlab-upenn/f110-fall2018-skeletons.git</a></dd>
</dl>
<p>Create a workspace folder if you haven’t already, here called f110_ws, and copy the simulator folder into it:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$​ mkdir -p f110_ws/src
$​ cp -r f110-fall2018-skeletons f110_ws/src/
</pre></div>
</div>
<p>You will need to install these with apt-get in order for the car and Gazebo simulator to work.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$​ sudo apt-get update
$​ sudo apt-get install ros-kinetic-ros-control ros-kinetic-ros-controllers ros-kinetic-gazebo-ros-control ros-kinetic-ackermann-msgs ros-kinetic-joy ros-kinetic-driver-base
</pre></div>
</div>
<p>Make all the Python scripts executable (by default they are set to non-executable when cloned from Github).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$​ ​cd​ f110_ws
$​ find . -name “*.py” -exec chmod +x <span class="o">{}</span> <span class="se">\;</span>
</pre></div>
</div>
<p>Move to your workspace folder and compile the code (catkin_make does more than code compilation - see online reference).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$​ catkin_make
</pre></div>
</div>
<p>Finally, source your working directory into your shell using</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$​ <span class="nb">source</span> devel/setup.bash
</pre></div>
</div>
<p>Congratulations! Your working directory is all set up. Now if you examine the contents of your workspace, you will see 3 folders (In the ROS world we call them meta-packages since they contain packages): algorithms, simulator, and system. Algorithms contains the brains of the car which run high level algorithms, such as wall following, pure pursuit, localization. Simulator contains racecar-simulator which is based off of MIT Racecar’s repository and includes some new worlds such as Levine 2nd floor loop. Simulator also contains f1_10_sim which contains some message types useful for passing drive parameters data from the algorithm nodes to the VESC nodes that drive the car. Lastly, System contains code from MIT Racecar that the car would not be able to work without. For instance, System contains ackermann_msgs (for Ackermann steering), racecar (which contains parameters for max speed, sensor IP addresses, and teleoperation), serial (for USB serial communication with VESC), and vesc (written by MIT for VESC to work with the racecar).</p>
</div>
<div class="section" id="udev-rules-setup">
<h2>Udev Rules Setup<a class="headerlink" href="#udev-rules-setup" title="Permalink to this headline">¶</a></h2>
<p>When you connect the VESC and LIDAR to the Jetson, the operating system will assign them device names of the form ​/dev/ttyACMx​, where x is a number that depends on the order in which they were plugged in. For example, if you plug in the LIDAR before you plug in the VESC, the LIDAR will be assigned the name /dev/ttyACM0​, and the VESC will be assigned /dev/ttyACM1​. This is a problem, as the car’s ROS configuration scripts need to know which device names the LIDAR and VESC are assigned, and these can vary every time we reboot the Jetson, depending on the order in which the devices are initialized.</p>
<p>Fortunately, Linux has a utility named ​udev​ that allows us to assign each device a “virtual” name based on its vendor and product IDs. For example, if we plug a USB device in and its vendor ID matches the ID for Hokuyo laser scanners (15d1), ​udev​ could assign the device the name ​/dev/sensors/hokuyo​ instead of the more generic /dev/ttyACMx​. This allows our configuration scripts to refer to things like ​/dev/sensors/hokuyo​ and /dev/sensors/vesc​, which do not depend on the order in which the devices were initialized. We will use udev to assign persistent device names to the LIDAR, VESC, and joypad by creating three configuration files (“rules”) in the directory ​/etc/udev/rules.d​.</p>
<p>First, as root, open ​/etc/udev/rules.d/99-hokuyo.rules​ in a text editor to create a new rules file for the Hokuyo. Copy the following rule exactly as it appears below and save it:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">KERNEL</span><span class="o">==</span><span class="s2">&quot;ttyACM[0-9]*&quot;</span>, <span class="nv">ACTION</span><span class="o">==</span><span class="s2">&quot;add&quot;</span>, ATTRS<span class="o">{</span>idVendor<span class="o">}==</span><span class="s2">&quot;15d1&quot;</span>, <span class="nv">MODE</span><span class="o">=</span><span class="s2">&quot;0666&quot;</span>, <span class="nv">GROUP</span><span class="o">=</span><span class="s2">&quot;dialout&quot;</span>, <span class="nv">SYMLINK</span><span class="o">+=</span><span class="s2">&quot;sensors/hokuyo&quot;</span>
</pre></div>
</div>
<p>Next, open ​/etc/udev/rules.d/99-vesc.rules​ and copy in the following rule for the VESC:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">KERNEL</span><span class="o">==</span><span class="s2">&quot;ttyACM[0-9]*&quot;</span>, <span class="nv">ACTION</span><span class="o">==</span><span class="s2">&quot;add&quot;</span>, ATTRS<span class="o">{</span>idVendor<span class="o">}==</span><span class="s2">&quot;0483&quot;</span>, ATTRS<span class="o">{</span>idProduct<span class="o">}==</span><span class="s2">&quot;5740&quot;</span>, <span class="nv">MODE</span><span class="o">=</span><span class="s2">&quot;0666&quot;</span>, <span class="nv">GROUP</span><span class="o">=</span><span class="s2">&quot;dialout&quot;</span>, <span class="nv">SYMLINK</span><span class="o">+=</span><span class="s2">&quot;sensors/vesc&quot;</span>
</pre></div>
</div>
<p>Then open ​/etc/udev/rules.d/99-joypad-f710.rules​ and add this rule for the joypad:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">KERNEL</span><span class="o">==</span><span class="s2">&quot;js[0-9]*&quot;</span>, <span class="nv">ACTION</span><span class="o">==</span><span class="s2">&quot;add&quot;</span>, ATTRS<span class="o">{</span>idVendor<span class="o">}==</span><span class="s2">&quot;046d&quot;</span>, ATTRS<span class="o">{</span>idProduct<span class="o">}==</span><span class="s2">&quot;c219&quot;</span>, <span class="nv">SYMLINK</span><span class="o">+=</span><span class="s2">&quot;input/joypad-f710&quot;</span>
Finally, trigger <span class="o">(</span>activate<span class="o">)</span> the rules by running

​$ sudo ​udevadm control --reload-rules <span class="o">&amp;&amp;</span> udevadm trigger​
</pre></div>
</div>
<p>Reboot your system, and you should find three new devices by running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt;&gt; ls /dev
/dev/sensors/hokuyo​
/dev/sensors/vesc​
/dev/input/joypad-f710​
</pre></div>
</div>
<p>If you want to add additional devices and don’t know their vendor or product IDs, you can use the command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo ​udevadm info --name<span class="o">=</span>&lt;your_device_name&gt; --attribute-walk
making sure to replace ​&lt;your_device_name&gt;​ with the name of your device <span class="o">(</span>e.g. ttyACM0 <span class="k">if</span> that’s what the OS assigned it. The Unix utility ​dmesg​ can <span class="nb">help</span> you find that<span class="o">)</span>. The topmost entry will be the entry <span class="k">for</span> your device<span class="p">;</span> lower entries are <span class="k">for</span> the device’s parents.
</pre></div>
</div>
</div>
<div class="section" id="manual-control">
<h2>Manual Control<a class="headerlink" href="#manual-control" title="Permalink to this headline">¶</a></h2>
<p>Before we can get the car to drive itself, it’s a good idea to test the car to make sure it can successfully drive on the ground under human control. Controlling the car manually is also a good idea if you’ve recently re-tuned the VESC or swapped out a drivetrain component, such as the motor or gears. Doing this step early can spare you a headache debugging your code later since you will be able to rule out lower-level hardware issues if your code doesn’t work.</p>
<p>Before you begin:</p>
<ul class="simple">
<li>Make sure you have the car running off its LIPO battery and that you have a Logitech F710 joypad handy with its receiver (i.e., USB dongle) plugged into the Jetson’s USB hub.</li>
<li>Make sure you have the VESC connected!</li>
<li>Ensure that both your car and laptop are connected to a wireless access point if you need the car connected to the Internet while you drive it. Otherwise, follow this tutorial​ so your laptop and phone can connect directly to the car.</li>
<li>Make sure you’ve cloned the course repository and set up your working directory (as explained ​here​)</li>
<li>This tutorial uses the program ​tmux​(available via apt-get) to let you run multiple terminals over one SSH connection. You can also use VNC​ if you prefer a GUI.</li>
</ul>
<p>Now, we’re ready to begin.</p>
<ol class="arabic simple">
<li>Open a terminal and SSH into the car from your computer. Once you’re in, run ​tmux​so that you can spawn new terminal sessions over the same SSH connection.</li>
<li>In your tmux session, spawn a new window (using ​``Ctrl-A “​``) and run ​roscore​ to start ROS.</li>
<li>In the other free terminal, navigate to your working directory, run <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">catkin</span> <span class="pre">make</span></code> and source the directory using <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">source</span> <span class="pre">devel/setup.bash</span></code>.</li>
<li>Run  <code class="docutils literal notranslate"><span class="pre">roslaunch</span> <span class="pre">racecar</span> <span class="pre">teleop.launch​</span></code>  to launch the car. Place the car on the ground and press the center button on your joystick so you can control the car. If this gives you a segmentation error, and it’s caused by compiling the joy package (which you can check by running the joy_node on its own), this could be because you are using the joy package from the ROS distribution (i.e., installed with apt-get). Remove that (11sudo apt-get remove joy11) and re-compile. This should compile the joy package that’s in the repo.</li>
<li><dl class="first docutils">
<dt>Hold the LB button on the controller to start controlling the car. Use the left joystick to move the car forward and backward and the right joystick for steering.</dt>
<dd><ul class="first last">
<li>If nothing happens, one reason can be that the joy_node is listening for inputs on the js0 port, but the OS has assigned a different port to it, like js1. Edit the yaml file which specifies which port to listen to. You can tell what file that is by reading the launch file (and following the call tree to other launch files).</li>
<li>Note that the LB button acts as a “dead man’s switch,” as releasing it will stop the car. This is for safety in case your car gets out of control.</li>
<li>You can see a mapping of all controls used by the car in <code class="docutils literal notranslate"><span class="pre">&lt;your</span> <span class="pre">catkin</span> <span class="pre">workspace&gt;/src/racecar/racecar/config/racecar-v2/joy_teleo</span> <span class="pre">p.yaml</span></code>. For example, in the default configuration, axis 1 (left joystick’s vertical axis) is used for throttle, and axis 2 (right joystick’s horizontal axis) is used for steering.</li>
</ul>
</dd>
</dl>
</li>
</ol>
<div class="section" id="troubleshooting">
<h3>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>If you’re getting “VESC out of sync errors”, check that the VESC is connected</li>
<li>If you get “SerialException” types of messages, ​and you’re using the 30LX Hokuyo​, the errors might be due to a port conflict: e.g., suppose that the lidar was assigned the (virtual serial bi-directional) port ttyACM0 by the OS. And suppose that the vesc_node is told the VESC is connected to port ttyACM0 (as per vesc.yaml). Then when the vesc_node receives joystick commands from joy_node (via ROS), it pushes them to ACM0 - so these messages actually go to the lidar, and the VESC gets garbage back. So change the vesc.yaml port entry to ttyACM1. (This whole discussion remains valid if you switch 0 and 1, i.e. if the OS assigned ACM1 to the lidar and your vesc.yaml lists ACM1). Note that everytime you power down and up, the OS will assign ports from scratch, which might again break your config files. So a better solution is to use udev rules, as explained in this ​section​. (See <code class="docutils literal notranslate"><span class="pre">joy_node.cpp</span></code> for the default port for the joystick. You can over-ride that using a parameter in the launch file. See the joy documentation for what parameter that is).</li>
<li>If you get <code class="docutils literal notranslate"><span class="pre">urg_node</span></code> related error messages, check the ports (e.g. an ip address in sensors.yaml can only be used by 10LX, not 30LX, and vice-versa for the /dev/ttyACM​n​).</li>
<li>If you get <code class="docutils literal notranslate"><span class="pre">razor_imu</span></code> errors, delete the IMU entry from the launch file - we’re not using an IMU in this build.</li>
</ul>
</div>
<div class="section" id="tuning-the-vesc-parameters">
<h3>Tuning the VESC Parameters<a class="headerlink" href="#tuning-the-vesc-parameters" title="Permalink to this headline">¶</a></h3>
<p>You may want to fine tune your VESC parameters to match them to your car. Why? You might notice that your car with the default parameters drifts slightly to the side, or isn’t going as fast as you want it to. In order to tune your VESC parameters, navigate to <code class="docutils literal notranslate"><span class="pre">racecar/racecar/config/racecar-v2/vesc.yaml</span></code>. The vesc.yaml file is a configuration file where you can set parameters for erpm gain, steering angle offset, speed_min, speed_max, etc.</p>
<p>If you want to modify the maximum speed, under vesc_driver you can change the speed_min and speed_max. These numbers represent the erpm of the car. By default they are set to +/- 3000 but you can set them higher, up to around 10,000. By default where speed_max is 3000 even though the joystick is telling the car to go 2 m/s (which corresponds to speed_to_erpm_gain * 2 = 9,228) your car will be limited by the 3000 erpm when 2 m/s actually corresponds to 9,228 erpm.</p>
<p>If your car’s motor is using a smaller or larger gear (where larger gear means you need lower erpm in order to achieve a certain speed), you will want to compensate for this by adjusting the speed_to_erpm_gain. For instance, I had to raise my speed_to_erpm_gain from the default setting of 4614 to 7442. The reason is that my motor has a smaller gear attached to it (they are swappable), so it needs more rotations in order to achieve the same speed. If I hadn’t increased the speed_to_erpm_gain, even though I was telling the car to go 2 m/s, in reality it was only going 1.2 m/s. And this was problematic because my /vesc/odom topic was publishing incorrect measurements - it was overestimating how far the car had traveled.</p>
<p>If you notice that your car is not going straight, then you will want to modify your steering_angle_to_servo_offset. By default the value is around 0.53, and you’ll want to increase or decrease this slightly until the car is going straight.</p>
<p>Other than these three parameters above, I didn’t change anything else but you are welcome to play around with these as you see fit. It’s a great learning experience!</p>
</div>
</div>
<div class="section" id="testing-the-lidar-usb-only">
<h2>Testing the Lidar (USB Only)<a class="headerlink" href="#testing-the-lidar-usb-only" title="Permalink to this headline">¶</a></h2>
<p>Once you’ve set up the LIDAR, you can test it using ​urg_node​, ​rviz​, and ​rostopic​.</p>
<ol class="arabic">
<li><p class="first">Connect the LiDAR to the power board (see section ​Connecting the LIDAR​), and plug the USB cable into a free port on your hub.</p>
</li>
<li><p class="first">Start ​  <code class="docutils literal notranslate"><span class="pre">roscore​</span></code>   in a terminal window.</p>
</li>
<li><p class="first">In another (new) terminal window, run ​  <code class="docutils literal notranslate"><span class="pre">rosrun</span> <span class="pre">urg_node</span> <span class="pre">urg_node​</span></code>  . This tells ROS to start reading from the LIDAR and publishing on the ​/scan​ topic. If you get an error saying that there is an “error connecting to Hokuyo,” double check that the Hokuyo is physically plugged into a USB port. You can use the terminal command ​  <code class="docutils literal notranslate"><span class="pre">lsusb​to</span></code>   check whether Linux successfully detected your LiDAR. If the node started and is publishing correctly, you should be able to use   <code class="docutils literal notranslate"><span class="pre">rostopic</span> <span class="pre">echo</span> <span class="pre">/scan​</span></code>   to see live LIDAR data.</p>
</li>
<li><p class="first">Open another terminal and run ​  <code class="docutils literal notranslate"><span class="pre">rosrun</span> <span class="pre">rviz</span> <span class="pre">rviz​</span></code>   to visually see the data. When   <code class="docutils literal notranslate"><span class="pre">rviz​</span></code>   opens, click the “Add” button at the lower left corner. A dialog will pop up; from here, click the “By topic” tab, highlight the “LaserScan” topic, and click OK.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">rviz</span></code>   will now show a collection of points (a point cloud) of the LIDAR data in the gray grid in the center of the screen. The points appear in colors ranging from green to red, with green points being closest to the LIDAR and red points being farthest away.</p>
<blockquote>
<div><ul class="simple">
<li>Try moving a flat object, such as a book, in front of the LIDAR and to its sides. You should see a corresponding flat line of points on the ​rviz​ grid.</li>
<li>Try picking the car up and moving it around, and note how the LIDAR scan data changes,</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">You can also see the LIDAR data in text form by using ​rostopic   <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">/scan``​</span>&#160; <span class="pre">.</span> <span class="pre">The</span> <span class="pre">type</span> <span class="pre">of</span> <span class="pre">message</span> <span class="pre">published</span> <span class="pre">to</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">sensor_msgs/Scan​,</span> <span class="pre">which</span> <span class="pre">you</span> <span class="pre">can</span> <span class="pre">also</span> <span class="pre">see</span> <span class="pre">by</span> <span class="pre">running</span> <span class="pre">​</span>&#160; <span class="pre">``rostopic</span> <span class="pre">info</span> <span class="pre">/scan​</span></code>  . There are many fields in this message type, but for our course, the most important one is ​ranges​, which is a list of distances the sensor records in order as it sweeps from its rightmost position to its leftmost position.</p>
</li>
</ol>
</div>
<div class="section" id="recording-bag-data-on-the-car">
<h2>Recording Bag Data on the Car<a class="headerlink" href="#recording-bag-data-on-the-car" title="Permalink to this headline">¶</a></h2>
<p>ROSbags​ are useful for recording data from the car (e.g. LIDAR, wheel rotation) and playing it back later. This feature is useful because it allows you to capture data from when the car is running and later study the data or perform analysis on it to help you develop and implement better racing algorithms.</p>
<p>One great thing about ROSbags compared to just recording the data into something simpler (like a CSV file) is that data is recorded along with the topics it was originally sent on. What this means is that when you later ​play​ the bag, the data will be transmitted on the same topics that it was originally sent on, ​and <em>any code that was listening to these topics can run, as if the data was being generated live​</em>.</p>
<p>For example, suppose I record LIDAR data being broadcasted on the ​/scan​ topic. When I later play the data back, the ​  <code class="docutils literal notranslate"><span class="pre">rostopic</span> <span class="pre">list​</span></code>   and ​  <code class="docutils literal notranslate"><span class="pre">rostopic</span> <span class="pre">echo​</span></code>   commands will show the LIDAR data being transmitted on the ​/scan​ topic as if the car was actually running!</p>
<p>Here’s a concrete example of how to use ROSbags to acquire motor telemetry data and play it back.</p>
<ol class="arabic">
<li><p class="first">Make sure both your computer and car are connected to the ​f110​ access point. Also, make sure your car is connected with a known static IP address. Open a terminal and SSH into the car. Once you’re in, run ​tmux​ so that you can spawn new terminal sessions over the same SSH connection.</p>
</li>
<li><p class="first">Follow the directions to clone the racecar repositories (more instructions coming soon). Clone these into your ROS working directory.</p>
</li>
<li><p class="first">In your tmux session, spawn a new window (using <code class="docutils literal notranslate"><span class="pre">​Ctrl-A</span> <span class="pre">“​</span></code>) and run ​``roscore​`` to start ROS.</p>
</li>
<li><p class="first">In the other free terminal, navigate to your working directory, run ​catkin make​, and source the directory using ​source devel/setup.bash​.</p>
</li>
<li><p class="first">Run ​  <code class="docutils literal notranslate"><span class="pre">roslaunch</span> <span class="pre">racecar</span> <span class="pre">teleop.launch​</span></code>   to launch the car. Place the car on the ground or on a stand and press the center button on your joystick so you can control the car.</p>
</li>
<li><p class="first">In your tmux session, spawn a new window and examine the list of active ROS topics using ​rostopic list​. Make sure that you can see the ​  <code class="docutils literal notranslate"><span class="pre">/vesc/sensors/core​</span> <span class="pre">topic</span></code>  , which contains drive motor parameters.</p>
</li>
<li><p class="first">Here’s where ROSbags come into play. Run ​  <code class="docutils literal notranslate"><span class="pre">rosbag</span> <span class="pre">record</span> <span class="pre">/vesc/sensors/core​</span></code>   to start recording the data. The data will start recording to a file in the current directory with naming format ​  <code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD-HH-MM-SS.bag​</span></code>  . Recording will continue until you press Control-C to kill the rosbag process.</p>
<blockquote>
<div><ul class="simple">
<li>If you get an error about low disk space, you can specify the directory to record to (e.g. on a USB flash drive or hard drive) after the topic name). For example, on my system, I would type   <code class="docutils literal notranslate"><span class="pre">rosbag</span> <span class="pre">record</span> <span class="pre">/vesc/sensors/core</span> <span class="pre">-o</span> <span class="pre">/media/ubuntu/Seagate\</span> <span class="pre">Backup\</span> <span class="pre">Plus\</span> <span class="pre">Drive/​</span></code>   to record into the root of my external hard drive.</li>
<li>Note that ​rosbag​ also supports recording multiple topics at the same time. For example, I could record both laser scan and motor data using rosbag record   <code class="docutils literal notranslate"><span class="pre">/vesc/sensors/core</span> <span class="pre">/scan</span></code></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Let the recording run for about 30 seconds. Drive the car around during this time using the controller and then hit to stop recording. (Important​: Quit the running        <a href="#id1"><span class="problematic" id="id2">``</span></a>teleop.launch``​  well.)</p>
</li>
<li><p class="first">Play the rosbag file using ​  <code class="docutils literal notranslate"><span class="pre">rosbag</span> <span class="pre">play</span> <span class="pre">&lt;your</span> <span class="pre">rosbag</span> <span class="pre">file&gt;​</span></code>. While the bag is playing, examine the topics list, and you will see a list of all topics that were recorded into the bag. Note that in addition to the topics you specified, ROS will also record the <code class="docutils literal notranslate"><span class="pre">rosout​</span></code>, <code class="docutils literal notranslate"><span class="pre">rosout_agg</span></code>, and ​``clock​`` topics, which can be useful for debugging.</p>
</li>
<li><p class="first">View that recorded motor data by echoing the <code class="docutils literal notranslate"><span class="pre">/vesc/sensors/core​</span></code> topic. Pay attention to how the motor RPM changed as you drove the car around. When the bag is out of data, it will stop publishing.</p>
</li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="simulation.html" class="btn btn-neutral float-right" title="Simulation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="wireless.html" class="btn btn-neutral float-left" title="Wireless" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2020, Juan Linietsky, Ariel Manzur and the Godot community (CC-BY 3.0)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>